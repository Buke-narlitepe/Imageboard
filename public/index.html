<!doctype html>
<html>
<head>
    <title>Imagegram</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@200;300&display=swap" rel="stylesheet">
</head>
<body>
    <div id="main">
        <h2><span class="imagegram">IG</span>Imagegram</h2>
        <form method="POST" @submit.prevent="handleSubmit" class="form">
            <input v-model="form.title" type="text" name="title" placeholder="title">
            <input v-model= "form.description" type="text" name="description" placeholder="description">
            <input v-model= "form.username" type="text" name="username" placeholder="username">
            <input @change="handleFile" type="file" name="file" accept="image/*" id="change">
            <button type="submit">Submit</button>
        </form>
        <p v-if="error">File is not attached properly.</p>
        <h3>Latest Images</h3>
        <div class="imageboard">
            <div class="images" v-for="image in images">
                <div class="user">
                    <img :src="image.url" class="icon" > 
                    <p class="username">{{image.username}}</p>
                    <img src="delete-icon.png" class="bin">
                </div>
                <img :src="image.url" @click = "openModal(image.id)" >
                <p class="title">{{image.title}}</p>
            </div>
        </div>
        <button v-if="hasMore" @click="loadMore" class="more">Load More</button>
        <image-component :id ="id" v-if="id" @close-the-component = "closingComponent" >
            </image-component>
    </div>
    <script id="image-component" type="text/x-template">
    <div class="background">
        <div class="modalpage">
            <h2 @click="closeModal" class="close">X</h2>
            <div class="imagepart">
                <img :src="url" class ="big">
                <p class="title">{{title}}</p>
                <p class="description">{{description}}</p>
                <p class="user">Created by {{username}} on {{created_at}}</p>
                <comment-component :id ="id"></comment-component>
            </div>
        </div>
    </div>
    </script>
    <script id="comment-component" type="text/x-template">
        <div>
          <form method="POST" @submit.prevent="handleSubmit" class="form">
              <input v-model="comment" type="text" name="comment" placeholder="comment">
              <input v-model= "username" type="text" name="username" placeholder="username">
              <button type="submit">Submit</button>
           </form>  
           <div class="commentpart" v-for="comment in comments">
               <div class="commentline">
                   <p class="comment">{{comment.comment}}</p>
                   <p class="commentinfo">{{comment.username}} on {{comment.created_at}}</p>
               </div>
           </div>
        </div>
    </script>

    <script src="/js/vue.js"></script>
    <script src="/js/axios.min.js"></script>
    <script src="/script.js"></script>
</body>
</html>
